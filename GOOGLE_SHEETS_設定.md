# Google Sheets 欄位設定指南

## 正確的 Google Sheets 欄位順序（重要！）

### 第一列（標題列）

請**完全按照以下順序**設定：

```
A欄: id
B欄: ticker
C欄: entry_date
D欄: total_amount
E欄: shares
F欄: strategy_type
G欄: is_sold
H欄: notes
I欄: sell_amount
J欄: sell_date
```

> [!IMPORTANT]
> **新增了兩個欄位**：`sell_amount`（賣出金額）和 `sell_date`（賣出日期）
> 這兩個欄位用於記錄出場資訊，計算損益報酬率

---

## 您目前的錯誤

### ❌ 您目前的順序：
```
A: id
B: ticker
C: entry_date
D: strategy_type    ← 錯誤！應該是 total_amount
E: shares           ← 錯誤！應該在 E 欄沒錯，但 D 欄錯了
F: total_amount     ← 錯誤！應該在 D 欄
G: is_sold
H: note             ← 錯誤！應該是 notes（有 s）
```

### ✅ 正確的順序：
```
A: id
B: ticker
C: entry_date
D: total_amount     ← 正確位置
E: shares           ← 正確位置
F: strategy_type    ← 正確位置
G: is_sold
H: notes            ← 注意複數形式
I: sell_amount      ← 新增：賣出金額
J: sell_date        ← 新增：賣出日期
```

---

## 快速修正步驟

### 步驟 1：備份現有資料（如果有）
如果您已經有資料，先複製到別處備份。

### 步驟 2：清空試算表
刪除所有內容（或建立新的工作表）。

### 步驟 3：設定標題列
在第一列（Row 1）依序輸入以下標題：

| A | B | C | D | E | F | G | H |
|---|---|---|---|---|---|---|---|
| id | ticker | entry_date | total_amount | shares | strategy_type | is_sold | notes |

### 步驟 4：設定 ticker 欄位為文字格式
1. 點擊 **B 欄**標題
2. 格式 → 數字 → 純文字

### 步驟 5：完成！
現在可以使用應用程式新增資料了。

---

## 範例資料

### 正確的資料格式：

| id | ticker | entry_date | total_amount | shares | strategy_type | is_sold | notes |
|----|--------|------------|--------------|--------|---------------|---------|-------|
| 2330_2026-01-24_20260124112000 | 2330 | 2026-01-24 | 50000 | 20 | Basic | FALSE | 台積電測試 |
| 6770_2026-01-24_20260124113000 | 6770 | 2026-01-24 | 100000 | 2000 | Add | FALSE | 力積電加碼 |

---

## 欄位詳細說明

### A 欄：id（唯一識別碼）
- **格式**：文字
- **說明**：系統自動產生，格式為 `股票代號_日期_時間戳記`
- **範例**：`2330_2026-01-24_20260124112000`
- **注意**：不要手動修改

### B 欄：ticker（股票代號）
- **格式**：**文字**（重要！）
- **說明**：台股代號，不含 .TW 或 .TWO
- **範例**：`2330`、`6770`、`0050`
- **設定**：務必設定為純文字格式

### C 欄：entry_date（進場日期）
- **格式**：日期或文字（YYYY-MM-DD）
- **說明**：購買日期
- **範例**：`2026-01-24`
- **注意**：格式必須是 YYYY-MM-DD

### D 欄：total_amount（總成本）
- **格式**：數字
- **說明**：購買的總金額（新台幣）
- **範例**：`50000`、`100000`
- **注意**：不要加千分位逗號

### E 欄：shares（股數）
- **格式**：數字
- **說明**：購買的股數
- **範例**：`20`、`1000`、`2000`
- **注意**：整數即可

### F 欄：strategy_type（策略類型）
- **格式**：文字
- **說明**：交易策略類型
- **範例**：`Basic` 或 `Add`
- **注意**：
  - `Basic` = 基礎單（守月線）
  - `Add` = 加碼單（守兩日低）
  - 大小寫要正確

### G 欄：is_sold（是否已出場）
- **格式**：布林值
- **說明**：部位是否已經賣出
- **範例**：`FALSE` 或 `TRUE`
- **注意**：
  - 新增時預設為 `FALSE`
  - 系統會自動更新為 `TRUE`
  - 全大寫

### H 欄：notes（備註）
- **格式**：文字
- **說明**：使用者自訂備註
- **範例**：`測試用`、`力積電第一筆`
- **注意**：選填，可以留空

---

## 常見錯誤

### ❌ 錯誤 1：欄位順序不對
**問題**：total_amount 和 strategy_type 位置對調
**解決**：按照正確順序重新設定

### ❌ 錯誤 2：notes 寫成 note
**問題**：少了 s
**解決**：改成 `notes`（複數）

### ❌ 錯誤 3：ticker 是數字格式
**問題**：2330 會變成數字
**解決**：設定 B 欄為純文字格式

### ❌ 錯誤 4：is_sold 寫成 false（小寫）
**問題**：應該全大寫
**解決**：改成 `FALSE` 或 `TRUE`

---

## 驗證設定是否正確

### 檢查清單：

✅ **第一列標題**
- [ ] A 欄是 `id`
- [ ] B 欄是 `ticker`
- [ ] C 欄是 `entry_date`
- [ ] D 欄是 `total_amount`（不是 strategy_type）
- [ ] E 欄是 `shares`
- [ ] F 欄是 `strategy_type`（不是 total_amount）
- [ ] G 欄是 `is_sold`
- [ ] H 欄是 `notes`（有 s）
- [ ] I 欄是 `sell_amount`（新增）
- [ ] J 欄是 `sell_date`（新增）

✅ **B 欄格式**
- [ ] 已設定為純文字格式
- [ ] 輸入 2330 後靠左對齊

✅ **試算表權限**
- [ ] 已共用給 `streamlit-bot@stock-trading-484313.iam.gserviceaccount.com`
- [ ] 權限設為「編輯者」

---

## 測試步驟

### 1. 使用應用程式新增一筆資料
- 股票代號：2330
- 股數：10
- 總成本：6000
- 進場日期：今天
- 策略類型：Basic
- 備註：測試

### 2. 檢查 Google Sheets
應該會看到新增一列，格式如下：
```
2330_2026-01-24_... | 2330 | 2026-01-24 | 6000 | 10 | Basic | FALSE | 測試
```

### 3. 檢查應用程式的庫存顯示
應該會顯示這筆資料，包含：
- 股票名稱（台積電）
- 現價
- 損益
- 出場價
- 建議

如果都正常顯示，就代表設定成功了！

---

## 需要幫助？

如果設定後還是有問題，請檢查：
1. 欄位順序是否完全正確
2. ticker 欄位是否為文字格式
3. 試算表是否已共用給服務帳戶
4. 應用程式是否已重新啟動

建議：**重新建立一個乾淨的工作表**，按照上述步驟重新設定，會比修改現有的更快更準確。
